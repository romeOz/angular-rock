!function(){"use strict";angular.module("rock.core",["rock.core.helpers","rock.core.services","rock.core.directives","rock.core.filters","rock.core.notification","rock.core.forms"])}(),function(){"use strict";function e(){var e={};return e.upperFirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.strpos=function(e,r,n){void 0===n&&(n=0);var t=e.indexOf(r,n);return t>=0?t:!1},e.reverse=function(e){return e.split("").reverse().join("")},e.strncmp=function(e,r,n){var t=(e+"").substr(0,n),o=(r+"").substr(0,n);return t==o?0:t>o?1:-1},e.strpos=function(e,r,n){var t=e.indexOf(r,n);return t>=0?t:!1},e.ltrim=function(e,r){r=r?(r+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" \\s ";var n=new RegExp("^["+r+"]+","g");return(e+"").replace(n,"")},e.rtrim=function(e,r){r=r?(r+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"\\$1"):" \\s ";var n=new RegExp("["+r+"]+$","g");return(e+"").replace(n,"")},e}function r(){var e={};return e.flatten=function(e,r){var n=angular.isArray(e),t=n?[]:{},o=function(e,n){angular.forEach(e,function(e,s){return angular.isObject(e)?void o(e,n):(angular.isFunction(r)&&(e=r(e)),void(n?t.push(e):t[s]=e))})};return o(e,n),t},e}function n(e,r){var n={},t={};return n.set=function(r,o){e.strncmp(r,"@",1)&&(r="@"+r);var s="/",i=e.strpos(r,s),c=i===!1?r:r.substr(0,i);null!==o?(o=e.strncmp(o,"@",1)?e.rtrim(o,"\\/"):n.get(o),void 0===t[c]?i===!1?t[c]=o:(t[c]={},t[c][r]=o):angular.isString(t[c])?i===!1?t[c]=o:(t[c]={},t[c][r]=o,t[c][c]=t[c]):t[c][r]=o):void 0!==t[c]&&(angular.isArray(t[c])?t[c][r]=void 0:i===!1&&(t[c]=void 0))},n.get=function(n){if(e.strncmp(n,"@",1))return n;var o="/",s=e.strpos(n,o),i=s===!1?n:n.substr(0,s);if(void 0!==t[i]){if(angular.isString(t[i]))return s===!1?t[i]:t[i]+n.substr(s);var c=_.find(t[i],function(r,t){return 0===e.strpos(n+o,t+o)?r+n.substr(t.length):void 0})}return void 0===c&&r.debug("Invalid path alias: "+n),c},n.remove=function(e){t[e]=void 0},n}angular.module("rock.core.helpers",[]).factory("stringHelper",e).factory("collectionHelper",r).factory("alias",n),n.$inject=["stringHelper","notification"]}(),function(){"use strict";function e(e,r,n,t,o){var s={};return e._user=void 0,s.set=function(r){e._user=t.removeExtend(r)},s.add=function(r,n){e._user||(e._user={}),e._user[r]=t.removeExtend(n)},s.get=function(r){return e._user&&void 0!==e._user[r]?e._user[r]:null},s.getAll=function(){return e._user},s.isLogged=function(){return void 0===e._user?void 0:!!e._user},s.logout=function(t){r.get(URI(t).setSearch(n.get())).success(function(){e._user=null,o.success("lang.successLogout"),e.$broadcast("onLogout")})},s}function r(){var e="Success.";this.defaultMsg=function(r){e=r},this.$get=["$http",function(e){var r={};return r.reloadCaptcha=function(r){return e.get(r)},r}]}function n(){var e="_extend",r="lang.failHTTPRequest";this.extendAttribute=function(r){e=r},this.defaultMsg=function(e){r=e},this.$get=["collectionHelper","stringHelper","csrfUtils","notification",function(n,t,o,s){function i(e){return n.flatten(e,function(e){return c(e)})}function c(e){return e=t.upperFirst(e),"."!==e.slice(-1)?e+".":e}var u={};return u.csrf=function(r,n){return angular.isObject(r)&&r[e]&&r[e].csrf?(o.addToken(r[e].csrf.token),void o.addParam(r[e].csrf.param)):void(angular.isFunction(n)&&o.addToken(n("x-csrf-token")))},u.normalizeAlerts=function(e,n,t){return e||(e=[t||r]),void 0===n&&(n=!0),e=i(u.removeExtend(e)),n===!0&&angular.isArray(e)&&(e=_.uniq(e)),e},u.getExtend=function(r,n){return angular.isObject(r)&&r[e]?n?r[e][n]||null:r[e]:null},u.removeExtend=function(r){return delete r[e],r},u.error=function(e,r,n){switch(e&&e.error&&e.error.message&&s.debug(e.error.message),r){case 400:case 422:break;case 403:s.error("lang.failAccess",{},c(n));break;case 404:s.error("lang.notPage",{},c(n));break;case 500:s.error("lang.failServer",{},c(n))}},u}]}function t(){var e={},r={token:void 0,param:void 0};return e.addToken=function(e){angular.isString(e)&&(r.token=e)},e.addParam=function(e){e&&(r.param=e)},e.get=function(){if(r.token&&r.param){var e={};return e[r.param]=r.token,e}return null},e.getToken=function(){return r.token},e.getParam=function(){return r.param},e.has=function(){return r&&r.token},e}function o(e,r){var n={};return n.show=function(e,n,t){r.open({templateUrl:n,controller:t})},n}function s(){var e='<iframe width="{{width}}" height="{{height}}" frameborder="0" allowfullscreen="allowfullscreen" src="{{src}}"></iframe>',r=480,n=360;this.video={width:function(e){r=e},height:function(e){n=e}},this.$get=["$modal","$interpolate",function(r,n){function t(e,r,t,o){return n(e)({width:t,height:o,src:r})}var o={};return o.playVideo=function(r,n,o,s,i){r&&(i.preventDefault(),angular.element(i.target).replaceWith(t(e,r,n,o)))},o.playVideoModal=function(n,o,s,i,c){function u(e,r){e.cancel=function(){r.dismiss("cancel")}}n&&(c.preventDefault(),u.$inject=["$scope","$modalInstance"],i&&(i='<div class="modal-header"><button data-ng-click="cancel()" class="close" type="button">×</button><h4 class="modal-title"><span class="glyphicon glyphicon-star"></span> '+i+"</h4></div>"),r.open({template:i+'<div class="modal-body">'+t(e,n,o,s)+"</div>",controller:u}))},o}]}angular.module("rock.core.services",[]).factory("userUtils",e).provider("formUtils",r).provider("httpUtils",n).factory("csrfUtils",t).factory("modalUtils",o).provider("htmlUtils",s),e.$inject=["$rootScope","$http","csrfUtils","httpUtils","notification"],o.$inject=["$templateCache","$modal"]}(),function(){"use strict";function e(e){return function(r){return"undefined"==typeof r||null===r?"":e.trustAsHtml(r)}}function r(){return function(e,r){return e&&angular.isObject(e)?(e=_.filter(e,function(e,n){return _.contains(r,n)}),_.isEmpty(e)?null:e):void 0}}angular.module("rock.core.filters",[]).filter("unsafe",e).filter("byKeys",r),e.$inject=["$sce"]}(),function(){"use strict";function e(e){return{restrict:"A",link:function(r,n){r.$root.$watch(function(){return e.getToken()},function(e){e&&n.attr("content",e)})}}}function r(e){return{restrict:"A",scope:{rawHtml:"=bindCompiledHtml"},link:function(r,n){r.$watch("rawHtml",function(t){if(t){var o=e(t)(r.$parent);n.contents().remove(),n.append(o)}})}}}function n(){return{restrict:"A",scope:{options:"=rockUrl"},link:function(e,r,n){if(e.options&&angular.isObject(e.options)){var t="href",o=e.options;if(o.attr&&(t=o.attr),n[t]){var s=URI(n[t]);o.self&&s.pathname(URI().pathname()),r.attr(t,s),o.csrf&&e.$root.$watch(function(e){return e.rock.csrf.getToken()},function(n){n&&r.attr(t,s.setSearch(e.$root.rock.csrf.get()))})}}}}}angular.module("rock.core.directives",[]).directive("bindCompiledHtml",r).directive("rockMetaCsrf",e).directive("rockUrl",n),e.$inject=["csrfUtils"],r.$inject=["$compile"]}(),function(){"use strict";angular.module("rock.core.notification",["rock.core.notification.controllers","rock.core.notification.services"])}(),function(){"use strict";function e(e,r){e.notifications=r.getAll(),e.merge=function(e){r.merge(e)},e.closeable=!0,e.closeAlert=function(e){r.remove(e)}}angular.module("rock.core.notification.controllers",["ui.bootstrap","ngAnimate"]).controller("NotificationController",e),e.$inject=["$scope","notification"]}(),function(){"use strict";function e(){var e=[],r=!0;this.debugEnabled=function(e){r=e},this.$get=["$translate",function(r){function n(n,t,o,s){var i=function(r){switch(n){case"warn":n="warning";break;case"error":n="danger";break;case"success":n="success";break;default:n="info"}e.push({msg:r,type:n})};r(t,o).then(i)["catch"](function(e){i(s||e)})}return{log:function(e,r,t){n("log",e,r,t)},info:function(e,r,t){n("info",e,r,t)},success:function(e,r,t){n("success",e,r,t)},warn:function(e,r,t){n("warn",e,r,t)},error:function(e,r,t){n("error",e,r,t)},debug:function(e){angular.isString(e)&&(e=new Error(e)),console.debug(e)},merge:function(r){r&&(angular.isString(r[0])&&(r=r.map(function(e){return{msg:e}})),angular.extend(e,r))},getAll:function(){return e},exists:function(){return!!e},remove:function(r){e&&e.splice(r,1)},removeAll:function(){e=[]}}}]}angular.module("rock.core.notification.services",[]).provider("notification",e)}(),function(){"use strict";angular.module("rock.core.forms",["rock.core.forms.controllers","rock.core.forms.services","rock.core.forms.directives"])}(),function(){"use strict";function e(){return{require:"ngModel",restrict:"A",scope:{match:"=rockMatch"},link:function(e,r,n,t){e.$watch(function(){var r=t.$modelValue||t.$$invalidModelValue;return t.$pristine&&angular.isUndefined(r)||e.match===r},function(e){t.$setValidity("match",e)})}}}function r(e){var r="ng-focused";return{restrict:"A",require:"ngModel",link:function(n,t,o,s){s.$focused=!1,t.bind("focus",function(n){t.addClass(r),e(function(){s.$focused=!1},0)}).bind("blur",function(n){t.removeClass(r),e(function(){s.$focused=!0},0)})}}}function n(e,r){return r.get("form/strong-password")||r.put("form/strong-password",'<progressbar value="value" type="{{class}}">{{value}}%</progressbar>'),{templateUrl:"form/strong-password",restrict:"A",scope:{pwd:"=rockPasswordStrong"},link:function(r){var n=function(r){var n,t,o,s,i={pos:{},neg:{}},c={pos:{},neg:{seqLetter:0,seqNumber:0,seqSymbol:0}},u=0,a="abcdefghijklmnopqrstuvwxyz",l="01234567890",f="\\!@#$%&/()=?¿";if(r){for(i.pos.lower=r.match(/[a-z]/g),i.pos.upper=r.match(/[A-Z]/g),i.pos.numbers=r.match(/\d/g),i.pos.symbols=r.match(/[$-/:-?{-~!^_`\[\]]/g),i.pos.middleNumber=r.slice(1,-1).match(/\d/g),i.pos.middleSymbol=r.slice(1,-1).match(/[$-/:-?{-~!^_`\[\]]/g),c.pos.lower=i.pos.lower?i.pos.lower.length:0,c.pos.upper=i.pos.upper?i.pos.upper.length:0,c.pos.numbers=i.pos.numbers?i.pos.numbers.length:0,c.pos.symbols=i.pos.symbols?i.pos.symbols.length:0,n=_.reduce(c.pos,function(e,r){return e+Math.min(1,r)},0),c.pos.numChars=r.length,n+=c.pos.numChars>=8?1:0,c.pos.requirements=n>=3?n:0,c.pos.middleNumber=i.pos.middleNumber?i.pos.middleNumber.length:0,c.pos.middleSymbol=i.pos.middleSymbol?i.pos.middleSymbol.length:0,i.neg.consecLower=r.match(/(?=([a-z]{2}))/g),i.neg.consecUpper=r.match(/(?=([A-Z]{2}))/g),i.neg.consecNumbers=r.match(/(?=(\d{2}))/g),i.neg.onlyNumbers=r.match(/^[0-9]*$/g),i.neg.onlyLetters=r.match(/^([a-z]|[A-Z])*$/g),c.neg.consecLower=i.neg.consecLower?i.neg.consecLower.length:0,c.neg.consecUpper=i.neg.consecUpper?i.neg.consecUpper.length:0,c.neg.consecNumbers=i.neg.consecNumbers?i.neg.consecNumbers.length:0,s=0;s<a.length-2;s++){var d=r.toLowerCase();o=a.substring(s,parseInt(s+3)),t=e.reverse(o),(-1!==d.indexOf(o)||-1!==d.indexOf(t))&&c.neg.seqLetter++}for(s=0;s<l.length-2;s++)o=l.substring(s,parseInt(s+3)),t=e.reverse(o),(-1!==r.indexOf(o)||-1!==r.toLowerCase().indexOf(t))&&c.neg.seqNumber++;for(s=0;s<f.length-2;s++)o=f.substring(s,parseInt(s+3)),t=e.reverse(o),(-1!==r.indexOf(o)||-1!==r.toLowerCase().indexOf(t))&&c.neg.seqSymbol++;c.neg.repeated=_.chain(r.toLowerCase().split("")).countBy(function(e){return e}).reject(function(e){return 1===e}).reduce(function(e,r){return e+r},0).value(),u+=4*c.pos.numChars,c.pos.upper&&(u+=2*(c.pos.numChars-c.pos.upper)),c.pos.lower&&(u+=2*(c.pos.numChars-c.pos.lower)),(c.pos.upper||c.pos.lower)&&(u+=4*c.pos.numbers),u+=6*c.pos.symbols,u+=2*(c.pos.middleSymbol+c.pos.middleNumber),u+=2*c.pos.requirements,u-=2*c.neg.consecLower,u-=2*c.neg.consecUpper,u-=2*c.neg.consecNumbers,u-=3*c.neg.seqNumber,u-=3*c.neg.seqLetter,u-=3*c.neg.seqSymbol,i.neg.onlyNumbers&&(u-=c.pos.numChars),i.neg.onlyLetters&&(u-=c.pos.numChars),c.neg.repeated&&(u-=c.neg.repeated/c.pos.numChars*10)}return Math.max(0,Math.min(100,Math.round(u)))},t=function(e){switch(Math.round(e/33)){case 0:case 1:return"danger";case 2:return"warning";case 3:return"success"}return""};r.$watch("pwd",function(){r.value=n(r.pwd),r["class"]=t(r.value)})}}}function t(){return{restrict:"A",require:"ngModel",link:function(e,r,n,t){e.$watch("isSend()",function(e){e===!0&&(t.$setViewValue(void 0),t.$setPristine(!0),t.$render())})}}}function o(e,r,n){return{require:"ngModel",link:function(t,o,s,i){var c;(c=r.get("form/reset-field-icon"))||(c='<i ng-show="enabled" ng-mousedown="resetField()" class="glyphicon glyphicon-remove-circle right-inner"></i>',r.put("form/reset-field-icon",c));var u=/text|search|tel|url|email|password/i;return"INPUT"!==o[0].nodeName?void n.debug(new Error("'resetField' is limited to input elements")):u.test(s.type)?(t=t.$new(),c=e(c)(t),o.after(c),t.resetField=function(){i.$setViewValue(void 0),i.$setPristine(!0),i.$render()},void o.bind("input",function(){t.enabled=!i.$isEmpty(o.val())}).bind("focus",function(){t.enabled=!i.$isEmpty(o.val()),t.$apply()}).bind("blur",function(){t.enabled=!1,t.$apply()})):void n.debug(new Error("Invalid input type for resetField: "+s.type))}}}angular.module("rock.core.forms.directives",["ui.bootstrap.progressbar","template/progressbar/progress.html","template/progressbar/progressbar.html"]).directive("rockFormFocus",r).directive("rockPasswordStrong",n).directive("rockMatch",e).directive("rockResetField",t).directive("rockResetFieldIcon",o),r.$inject=["$timeout"],n.$inject=["stringHelper","$templateCache"],o.$inject=["$compile","$templateCache","notification"]}(),function(){"use strict";angular.module("rock.core.forms.services",[])}(),function(){"use strict";function e(e){return function(r,n){return r?(void 0===n&&(n=!0),e.normalizeAlerts(r,n)):void 0}}function r(e,r,n,t,o,s,i){function c(r){e.sending=!1,r&&(e["class"]="alert-success",n("lang.success").then(function(r){e.response.messages||(e.response.messages=[]),e.response.messages.push(r)}))}function u(r,n){e.sending=!1,e["class"]="alert-danger",422===n&&(e.response.messages=r)}e.response={},e.sending=!1,e["class"]="alert-danger",e.formName=null,e.validateOnChanged=!1,e.isSend=function(){return e.sending},e.addAlert=function(r,n){e.response.messages||(e.response.messages={}),e.response.messages[r]=n},e.getAlert=function(r){return e.isAlerts()?e.response.messages[r]:void 0},e.getAlerts=function(){return e.response.messages},e.isAlerts=function(){return!!e.response.messages},e.existsAlert=function(r){return e.isAlerts()?!!e.response.messages[r]:!1},e.clear=function(){e.response={}},e.pristine=function(r){var n=e.formName;return e[n]&&e[n][r]?e[n][r].$pristine:!1},e.invalid=function(r){var n=e.formName;return e[n]&&e[n][r]?e[n][r].$invalid:!0},e.bindError=function(r){return e.getAlert(r)},e.showError=function(r,n){var t=e.formName;return e[t]&&e[t][r]?e.validateOnChanged?(e[t][r].$dirty||e[t].$submitted)&&(e[t][r].$focused||e[t].$submitted)&&e[t][r].$error[n]:(e[t][r].$dirty||e[t].$submitted)&&e[t][r].$error[n]:!1},e.hideError=function(r){var n=e.formName;return e[n]&&e[n][r]?e[n][r].$valid:!1},e.showHighlightError=function(r){var n=e.formName;return e[n]&&e[n][r]?e.validateOnChanged?!e[n][r].$invalid||!e[n][r].$focused&&!e[n].$submitted||e[n][r].$pristine&&!e[n].$submitted?"":"has-error":!e[n][r].$invalid||e[n][r].$pristine&&!e[n].$submitted?"":"has-error":""},e.getCaptcha=function(){return e.response.captcha},e.reloadCaptcha=function(e,r){e&&(r.preventDefault(),o.reloadCaptcha(e).success(function(e){return e?void(r.target.src=e):void i.debug('Request data "captcha" is empty.')}))},e.submit=function(n,o){var s,a={};if(!e.formName)return i.debug("Name of form is empty"),void o.preventDefault();if(s=e.formName,e[s].$setSubmitted(),e[s].$invalid)return void o.preventDefault();if(n){if(o.preventDefault(),e[s].$submitted=!1,!e[s].values)return void i.debug("Values of form is empty");e.clear(),e.sending=!0,a[s]=e[s].values,a[s][t.getParam()]=t.getToken(),r.post(n,a).success(c).error(u)}},e.logout=function(e,r){e&&(r.preventDefault(),s.logout(e))}}angular.module("rock.core.forms.controllers",["pascalprecht.translate"]).controller("RockFormController",r).filter("normalizeAlerts",e),e.$inject=["httpUtils"],r.$inject=["$scope","$http","$translate","csrfUtils","formUtils","userUtils","notification"]}();